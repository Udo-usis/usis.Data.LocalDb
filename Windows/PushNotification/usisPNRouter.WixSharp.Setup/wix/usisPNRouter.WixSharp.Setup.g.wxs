<?xml version="1.0" encoding="Windows-1252"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="f7bcded2-e648-4ea5-b5cb-2c46caf15e1f" Name="usis Push Notification Router" Language="1033" Codepage="Windows-1252" Version="1.3.8.0" UpgradeCode="c8ef682c-189b-4a8c-91a7-7c4758de4e2f" Manufacturer="usis GmbH">
    <Package InstallerVersion="200" Compressed="yes" Platform="x64" SummaryCodepage="Windows-1252" Languages="1033" />
    <Media Id="1" Cabinet="usis_Push_Notification_Router.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder" Name="ProgramFiles64Folder">
        <Directory Id="ProgramFiles64Folder.usis" Name="usis">
          <Directory Id="INSTALLDIR" Name="usisPNRouter">

            <Component Id="Component.usisPNRouter.exe" Guid="687834eb-62c4-4131-9093-a02d35e1055d" Win64="yes">
              <File Id="usisPNRouter.exe" Source="usisPNRouter.exe" />

              <ServiceInstall Id="usisPNRouter_" Name="usisPNRouter" DisplayName="usis Push Notification Router" Description="Provides services to send push notifications to mobile devices." Type="ownProcess" Start="auto" ErrorControl="normal" Arguments="-service">
                <ServiceConfig DelayedAutoStart="yes" OnInstall="yes" OnReinstall="no" OnUninstall="no" />
              </ServiceInstall>

              <ServiceControl Id="StopusisPNRouter_" Name="usisPNRouter" Stop="both" Wait="yes" />
              <ServiceControl Id="StartusisPNRouter_" Name="usisPNRouter" Start="install" Wait="no" />
              <ServiceControl Id="RemoveusisPNRouter_" Name="usisPNRouter" Remove="uninstall" Wait="yes" />
            </Component>

            <Component Id="Component.usisPNRouter.exe.config" Guid="687834eb-62c4-4131-9093-a02dbf73c339" Win64="yes">
              <File Id="usisPNRouter.exe.config" Source="usisPNRouter.exe.config" />
            </Component>

            <Component Id="Component.Newtonsoft.Json.dll" Guid="687834eb-62c4-4131-9093-a02da420e745" Win64="yes">
              <File Id="Newtonsoft.Json.dll" Source="Newtonsoft.Json.dll" />
            </Component>

            <Component Id="Component._...icrosoft.ManagementConsole.dll" Guid="687834eb-62c4-4131-9093-a02d17be7692" Win64="yes">
              <File Id="_...icrosoft.ManagementConsole.dll" Source="Microsoft.ManagementConsole.dll" />
            </Component>

            <Component Id="Component.CsvHelper.dll" Guid="687834eb-62c4-4131-9093-a02d2259e9e9" Win64="yes">
              <File Id="CsvHelper.dll" Source="CsvHelper.dll" />
            </Component>

            <Component Id="Component.usisPNRouter.msc" Guid="687834eb-62c4-4131-9093-a02d90070552" Win64="yes">
              <File Id="usisPNRouter.msc" Source="usisPNRouter.msc">
                <Shortcut Id="Shortcut.usisPNRouter.msc.usis_Push_Notification_Router_" WorkingDirectory="INSTALLDIR" Directory="ProgramMenuFolder.usis" Name="usis Push Notification Router.lnk" />
              </File>

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.usisPNRouter.chm" Guid="687834eb-62c4-4131-9093-a02df08b066d" Win64="yes">
              <File Id="usisPNRouter.chm" Source="..\usis.PushNotification.Documentation\Help\usisPNRouter.chm" />
            </Component>

            <Component Id="Component.usis.ApplicationServer.dll" Guid="687834eb-62c4-4131-9093-a02d322db2d6" Win64="yes">
              <File Id="usis.ApplicationServer.dll" Source="usis.ApplicationServer.dll" />
            </Component>

            <Component Id="Component._...plicationServer.Interfaces.dll" Guid="687834eb-62c4-4131-9093-a02d19278bef" Win64="yes">
              <File Id="_...plicationServer.Interfaces.dll" Source="usis.ApplicationServer.Interfaces.dll" />
            </Component>

            <Component Id="Component._...s.Framework.Entity.Windows.dll" Guid="687834eb-62c4-4131-9093-a02dadd8107e" Win64="yes">
              <File Id="_...s.Framework.Entity.Windows.dll" Source="usis.Framework.Entity.Windows.dll" />
            </Component>

            <Component Id="Component._...ramework.ManagementConsole.dll" Guid="687834eb-62c4-4131-9093-a02df4f03961" Win64="yes">
              <File Id="_...ramework.ManagementConsole.dll" Source="usis.Framework.ManagementConsole.dll" />
            </Component>

            <Component Id="Component.usis.Framework.Resources.dll" Guid="687834eb-62c4-4131-9093-a02de3e2a9d3" Win64="yes">
              <File Id="usis.Framework.Resources.dll" Source="usis.Framework.Resources.dll" />
            </Component>

            <Component Id="Component.usis.Framework.Windows.dll" Guid="687834eb-62c4-4131-9093-a02d70dfa886" Win64="yes">
              <File Id="usis.Framework.Windows.dll" Source="usis.Framework.Windows.dll" />
            </Component>

            <Component Id="Component.usis.ManagementConsole.dll" Guid="687834eb-62c4-4131-9093-a02ddae15e46" Win64="yes">
              <File Id="usis.ManagementConsole.dll" Source="usis.ManagementConsole.dll" />
            </Component>

            <Component Id="Component.usis.Platform.Resources.dll" Guid="687834eb-62c4-4131-9093-a02d3f921638" Win64="yes">
              <File Id="usis.Platform.Resources.dll" Source="usis.Platform.Resources.dll" />
            </Component>

            <Component Id="Component.usis.Platform.Windows.dll" Guid="687834eb-62c4-4131-9093-a02dd64b1256" Win64="yes">
              <File Id="usis.Platform.Windows.dll" Source="usis.Platform.Windows.dll" />
            </Component>

            <Component Id="Component._...ation.Administration.About.dll" Guid="687834eb-62c4-4131-9093-a02d30c04c1c" Win64="yes">
              <File Id="_...ation.Administration.About.dll" Source="usis.PushNotification.Administration.About.dll" />
            </Component>

            <Component Id="Component._...otification.Administration.dll" Guid="687834eb-62c4-4131-9093-a02ded83082d" Win64="yes">
              <File Id="_...otification.Administration.dll" Source="usis.PushNotification.Administration.dll" />
            </Component>

            <Component Id="Component._...ushNotification.Interfaces.dll" Guid="687834eb-62c4-4131-9093-a02daec1ffcd" Win64="yes">
              <File Id="_...ushNotification.Interfaces.dll" Source="usis.PushNotification.Interfaces.dll" />
            </Component>

            <Component Id="Component._....PushNotification.Portable.dll" Guid="687834eb-62c4-4131-9093-a02dc486ee35" Win64="yes">
              <File Id="_....PushNotification.Portable.dll" Source="usis.PushNotification.Portable.dll" />
            </Component>

            <Component Id="Component._...shNotification.Router.Apns.dll" Guid="687834eb-62c4-4131-9093-a02d16a3c8b0" Win64="yes">
              <File Id="_...shNotification.Router.Apns.dll" Source="usis.PushNotification.Router.Apns.dll" />
            </Component>

            <Component Id="Component._...is.PushNotification.Router.dll" Guid="687834eb-62c4-4131-9093-a02d430a4ede" Win64="yes">
              <File Id="_...is.PushNotification.Router.dll" Source="usis.PushNotification.Router.dll" />
            </Component>

            <Component Id="Component.usis.Server.dll" Guid="687834eb-62c4-4131-9093-a02df10d5bb0" Win64="yes">
              <File Id="usis.Server.dll" Source="usis.Server.dll" />
            </Component>

            <Component Id="Component.PushSharp.Apple.dll" Guid="687834eb-62c4-4131-9093-a02d8911c325" Win64="yes">
              <File Id="PushSharp.Apple.dll" Source="PushSharp.Apple.dll" />
            </Component>

            <Component Id="Component.PushSharp.Core.dll" Guid="687834eb-62c4-4131-9093-a02d83365127" Win64="yes">
              <File Id="PushSharp.Core.dll" Source="PushSharp.Core.dll" />
            </Component>

            <Component Id="Component.MySql.Data.dll" Guid="687834eb-62c4-4131-9093-a02d7735001a" Win64="yes">
              <File Id="MySql.Data.dll" Source="MySql.Data.dll" />
            </Component>

            <Component Id="Component.MySql.Data.Entity.EF6.dll" Guid="687834eb-62c4-4131-9093-a02d09828a75" Win64="yes">
              <File Id="MySql.Data.Entity.EF6.dll" Source="MySql.Data.Entity.EF6.dll" />
            </Component>

            <Component Id="Component.EntityFramework.dll" Guid="687834eb-62c4-4131-9093-a02d33a3eae2" Win64="yes">
              <File Id="EntityFramework.dll" Source="EntityFramework.dll" />
            </Component>

            <Component Id="Component.EntityFramework.SqlServer.dll" Guid="687834eb-62c4-4131-9093-a02dfef7153a" Win64="yes">
              <File Id="EntityFramework.SqlServer.dll" Source="EntityFramework.SqlServer.dll" />
            </Component>

          </Directory>
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder" Name="ProgramMenuFolder">
        <Directory Id="ProgramMenuFolder.usis" Name="usis">

          <Component Id="usis.EmptyDirectory" Guid="687834eb-62c4-4131-9093-a02ddb62cbd7" Win64="yes">
            <CreateFolder />
            <RemoveFolder Id="ProgramMenuFolder.usis" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

        </Directory>
      </Directory>
    </Directory>

    <Upgrade Id="c8ef682c-189b-4a8c-91a7-7c4758de4e2f">
      <UpgradeVersion Minimum="0.0.0.0" Maximum="1.3.8.0" IncludeMinimum="yes" IncludeMaximum="no" Property="UPGRADEFOUND" />
      <UpgradeVersion Minimum="1.3.8.0" IncludeMinimum="no" Property="NEWPRODUCTFOUND" />
    </Upgrade>

    <UI>
      <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="SetupTypeDlg" Order="5">1</Publish>
      <Publish Dialog="SetupTypeDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg" Order="5">1</Publish>
    </UI>

    <Icon Id="app_icon.ico" SourceFile="..\..\..\usisPNRouter.WixSharp.Setup\usis.icon.64x64.ico" />

    <CustomAction Id="_...ion1SetProp_ARPINSTALLLOCATION" Property="ARPINSTALLLOCATION" Value="[INSTALLDIR]" Return="check" Execute="immediate" />
    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryKey="Action2_WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="WixSharp_BeforeInstall_Action" BinaryKey="Action2_WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_BeforeInstall_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_WixSharp_AfterInstall_Action_Props" Property="WixSharp_AfterInstall_Action" Value="WixSharp_AfterInstall_Handlers=[WixSharp_AfterInstall_Handlers];WIXSHARP_RUNTIME_DATA=[WIXSHARP_RUNTIME_DATA];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductName=[ProductName];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode]" />
    <CustomAction Id="WixSharp_AfterInstall_Action" BinaryKey="Action2_WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_AfterInstall_Action" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="PreventDowngrading" Error="Newer version already installed" />

    <Binary Id="Action2_WixSharp_InitRuntime_Action_File" SourceFile="..\..\..\usisPNRouter.WixSharp.Setup\WixSharp.CA.dll" />

    <UIRef Id="WixUI_Mondo" />

    <Property Id="WixSharp_BeforeInstall_Handlers" Value="WixSharp Setup, Version=1.3.8.0, Culture=neutral, PublicKeyToken=null|usisPNRouter.WixSharp.Setup.Program+&lt;&gt;c|&lt;Main&gt;b__1_0" />
    <Property Id="WixSharp_AfterInstall_Handlers" Value="WixSharp Setup, Version=1.3.8.0, Culture=neutral, PublicKeyToken=null|usisPNRouter.WixSharp.Setup.Program+&lt;&gt;c|&lt;Main&gt;b__1_1" />
    <Property Id="ARPPRODUCTICON" Value="app_icon.ico" />

    <Feature Id="Push_Notification_Router" Title="Push Notification Router" Absent="allow" Level="1" Description="usis Push Notification Router">
      <ComponentRef Id="Component.usisPNRouter.exe" />
      <ComponentRef Id="Component.usisPNRouter.exe.config" />
      <ComponentRef Id="Component.Newtonsoft.Json.dll" />
      <ComponentRef Id="Component._...icrosoft.ManagementConsole.dll" />
      <ComponentRef Id="Component.CsvHelper.dll" />
      <ComponentRef Id="Component.usisPNRouter.msc" />
      <ComponentRef Id="Component.usisPNRouter.chm" />
      <ComponentRef Id="Component.usis.ApplicationServer.dll" />
      <ComponentRef Id="Component._...plicationServer.Interfaces.dll" />
      <ComponentRef Id="Component._...s.Framework.Entity.Windows.dll" />
      <ComponentRef Id="Component._...ramework.ManagementConsole.dll" />
      <ComponentRef Id="Component.usis.Framework.Resources.dll" />
      <ComponentRef Id="Component.usis.Framework.Windows.dll" />
      <ComponentRef Id="Component.usis.ManagementConsole.dll" />
      <ComponentRef Id="Component.usis.Platform.Resources.dll" />
      <ComponentRef Id="Component.usis.Platform.Windows.dll" />
      <ComponentRef Id="Component._...ation.Administration.About.dll" />
      <ComponentRef Id="Component._...otification.Administration.dll" />
      <ComponentRef Id="Component._...ushNotification.Interfaces.dll" />
      <ComponentRef Id="Component._....PushNotification.Portable.dll" />
      <ComponentRef Id="Component._...shNotification.Router.Apns.dll" />
      <ComponentRef Id="Component._...is.PushNotification.Router.dll" />
      <ComponentRef Id="Component.usis.Server.dll" />
      <ComponentRef Id="Component.PushSharp.Apple.dll" />
      <ComponentRef Id="Component.PushSharp.Core.dll" />
      <ComponentRef Id="Component.EntityFramework.dll" />
      <ComponentRef Id="Component.EntityFramework.SqlServer.dll" />
      <ComponentRef Id="usis.EmptyDirectory" />

      <Feature Id="MySQL_support" Title="MySQL support" Absent="allow" Level="1" Description="MySQL support">
        <ComponentRef Id="Component.MySql.Data.dll" />
        <ComponentRef Id="Component.MySql.Data.Entity.EF6.dll" />
      </Feature>
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="_...ion1SetProp_ARPINSTALLLOCATION" After="InstallValidate"> (NOT Installed) </Custom>
      <Custom Action="WixSharp_InitRuntime_Action" Before="AppSearch"> (1) </Custom>
      <Custom Action="WixSharp_BeforeInstall_Action" Before="InstallFiles">1</Custom>
      <Custom Action="Set_WixSharp_AfterInstall_Action_Props" After="InstallFiles" />
      <Custom Action="WixSharp_AfterInstall_Action" After="Set_WixSharp_AfterInstall_Action_Props">1</Custom>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>

      <RemoveExistingProducts After="InstallInitialize" />
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
    </InstallUISequence>

  </Product>
</Wix>

